{
    "contents" : "\n# This is the server logic for a Shiny web application.\n# You can find out more about building applications with Shiny here:\n#\n# http://shiny.rstudio.com\n#\n\nlibrary(shiny)\nlibrary(ggplot2)\n\nshinyServer(function(input, output)\n  {\n  \n  indexInput <- reactive({\n    switch(input$index,\n           \"cpu usage\" = cctv.cpu.all,\n           \"db time\" = cctv.dbtime.all,\n           \"sql hard parse\" = cctv.sqlhardparse.all,\n           \"sql parse\" = cctv.sqlparse.all,\n           \"redo\" = cctv.redo.all,\n           \"user call\" = cctv.usercall.all,\n           \"phyical read\" = cctv.phyread.all,\n           \"sql executions\" = cctv.exec.all\n           )\n  })\n  \n  \n\n    \n#  if(is.null(dataset) != TRUE)\n#    dataset.sub <- subset(dataset, DATE = input$dates)\n  \n  output$Outlier.DataSourceApp <- renderPrint({\n    #mdate <- mydate()\n    datasets <- indexInput()\n    #if(is.null(datasets) != TRUE)\n          #datasets[1,]\n    dsisubset <- subset(datasets,APP_NAME==\"DataSourceApp\")\n    \n    outliers <- which(dsisubset$VALUE_DELTA %in% boxplot.stats(dsisubset$VALUE_DELTA)$out)\n    #outliers <- which(subset(datasets,APP_NAME=\"DataSouInterface\")$VALUE_DELTA %in% boxplot.stats(subset(datasets,APP_NAME=\"DataSouInterface\")$VALUE_DELTA)$out)\n    #head(subset(datasets,APP_NAME==\"DataSouInterface\")[outliers,c(\"APP_NAME\",\"SNAP_TIME\",\"VALUE_DELTA\")])\n    head(dsisubset[outliers,c(\"APP_NAME\",\"SNAP_TIME\",\"VALUE_DELTA\")])\n    #head(datasets[,c(\"APP_NAME\",\"SNAP_TIME\",\"VALUE_DELTA\")])\n    #tail(datasets[,c(\"APP_NAME\",\"SNAP_TIME\",\"VALUE_DELTA\")])\n    #which(datasets$VALUE_DELTA == (sort(datasets$VALUE_DELTA,decreasing=TRUE))[1:5])\n    })\n\n    output$Outlier.DataSouInterface <- renderPrint({\n      #mdate <- mydate()\n      datasets <- indexInput()\n      #if(is.null(datasets) != TRUE)\n      #datasets[1,]\n      dsisubset <- subset(datasets,APP_NAME==\"ConvertBridge\")\n      \n      outliers <- which(dsisubset$VALUE_DELTA %in% boxplot.stats(dsisubset$VALUE_DELTA)$out)\n      #outliers <- which(subset(datasets,APP_NAME=\"DataSouInterface\")$VALUE_DELTA %in% boxplot.stats(subset(datasets,APP_NAME=\"DataSouInterface\")$VALUE_DELTA)$out)\n      #head(subset(datasets,APP_NAME==\"DataSouInterface\")[outliers,c(\"APP_NAME\",\"SNAP_TIME\",\"VALUE_DELTA\")])\n      head(dsisubset[outliers,c(\"APP_NAME\",\"SNAP_TIME\",\"VALUE_DELTA\")])\n      #head(datasets[,c(\"APP_NAME\",\"SNAP_TIME\",\"VALUE_DELTA\")])\n      #tail(datasets[,c(\"APP_NAME\",\"SNAP_TIME\",\"VALUE_DELTA\")])\n      #which(datasets$VALUE_DELTA == (sort(datasets$VALUE_DELTA,decreasing=TRUE))[1:5])\n    })  \n\n    output$Outlier.BBoardBridge <- renderPrint({\n      #mdate <- mydate()\n      datasets <- indexInput()\n      #if(is.null(datasets) != TRUE)\n      #datasets[1,]\n      dsisubset <- subset(datasets,APP_NAME==\"BBoardBridge\")\n      \n      outliers <- which(dsisubset$VALUE_DELTA %in% boxplot.stats(dsisubset$VALUE_DELTA)$out)\n      #outliers <- which(subset(datasets,APP_NAME=\"DataSouInterface\")$VALUE_DELTA %in% boxplot.stats(subset(datasets,APP_NAME=\"DataSouInterface\")$VALUE_DELTA)$out)\n      #head(subset(datasets,APP_NAME==\"DataSouInterface\")[outliers,c(\"APP_NAME\",\"SNAP_TIME\",\"VALUE_DELTA\")])\n      head(dsisubset[outliers,c(\"APP_NAME\",\"SNAP_TIME\",\"VALUE_DELTA\")])\n      #head(datasets[,c(\"APP_NAME\",\"SNAP_TIME\",\"VALUE_DELTA\")])\n      #tail(datasets[,c(\"APP_NAME\",\"SNAP_TIME\",\"VALUE_DELTA\")])\n      #which(datasets$VALUE_DELTA == (sort(datasets$VALUE_DELTA,decreasing=TRUE))[1:5])\n    })\n  \n  \n  output$indexplot <- renderPlot({\n    \n    datasets <- indexInput()\n    \n    xtime <- strptime(cctv.dbtime.all$TIME,\"%H:%M:%S\")\n    \n \n    ggplot(datasets, aes(x=strptime(xtime,\"%H:%M:%S\"),\n                                 y=VALUE_DELTA,fill=APP_NAME)) + \n                                  geom_area() + \n                                  scale_fill_manual(values=c(\"#999999\",\"#E69F00\",\"#56B4E9\",\"#009e73\",\"#F0E442\",\"#0072B2\",\"#D55E00\",\"#CC79A7\")) + \n                                  facet_wrap(~DATE,ncol=1) + \n                                  theme(axis.text.x = element_text(angle=30,hjust=1)) + \n                                  xlab(\"Snap Time, step: 10 minutes\") + \n                                  ylab(\"Index of Applications\") + \n                                  ggtitle(\"Index Accumulation of Applications\")\n\n    #hist(dataset$VALUE_DELTA)\n    \n  })\n  \n  \n  \n\n})\n",
    "created" : 1431923468501.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2179891724",
    "id" : "82C02D1F",
    "lastKnownWriteTime" : 1432822772,
    "path" : "D:/Bigdata/R/myshiny2/server.R",
    "project_path" : "server.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}